{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ | Edu Hub</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="{% static 'css/pages/test.css' %}">
</head>
<body>
    <div class="test-container">
        <a href="/" class="back-home">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"/>
            </svg>
            –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é
        </a>

        <div class="test-header">
            <h1>üéØ –¢–µ—Å—Ç –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏</h1>
            <p>–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ç–≤–æ–µ–π –ª–∏—á–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –∏–¥–µ–∞–ª—å–Ω–æ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏. –û—Ç–≤–µ—á–∞–π —á–µ—Å—Ç–Ω–æ ‚Äî —ç—Ç–æ –¥–ª—è —Ç–µ–±—è!</p>
        </div>

        <!-- Progress -->
        <div class="progress-container" id="progressContainer" style="display: none;">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="progress-text" id="progressText" style="display: none;">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 10</div>

        <!-- Intro Screen -->
        <div class="question-card active" id="introScreen">
            <div class="intro-screen">
                <div class="emoji-big">üß†</div>
                <h2>–ì–æ—Ç–æ–≤ —É–∑–Ω–∞—Ç—å —Å–≤–æ—é –∏–¥–µ–∞–ª—å–Ω—É—é –ø—Ä–æ—Ñ–µ—Å—Å–∏—é?</h2>
                <p>–≠—Ç–æ—Ç —Ç–µ—Å—Ç ‚Äî –Ω–µ –æ–±—ã—á–Ω—ã–π –æ–ø—Ä–æ—Å–Ω–∏–∫. –ú—ã –∏—Å—Å–ª–µ–¥—É–µ–º —Ç–≤–æ–π —Å–ø–æ—Å–æ–± –º—ã—à–ª–µ–Ω–∏—è, —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∏—Ä–æ–¥–Ω—ã–µ —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç–∏.</p>
                
                <div class="intro-features">
                    <div class="intro-feature">
                        <div class="icon">‚è±Ô∏è</div>
                        <h4>10-15 –º–∏–Ω—É—Ç</h4>
                        <p>–ù–µ —Ç–æ—Ä–æ–ø–∏—Å—å, –æ–±–¥—É–º–∞–π –∫–∞–∂–¥—ã–π –æ—Ç–≤–µ—Ç</p>
                    </div>
                    <div class="intro-feature">
                        <div class="icon">üé≠</div>
                        <h4>–ß–µ—Å—Ç–Ω–æ—Å—Ç—å</h4>
                        <p>–û—Ç–≤–µ—á–∞–π –∫–∞–∫ –µ—Å—Ç—å, –Ω–µ –ø—ã—Ç–∞–π—Å—è –≤—ã–≥–ª—è–¥–µ—Ç—å –ª—É—á—à–µ</p>
                    </div>
                    <div class="intro-feature">
                        <div class="icon">ü§ñ</div>
                        <h4>AI-–∞–Ω–∞–ª–∏–∑</h4>
                        <p>–ù–µ–π—Ä–æ—Å–µ—Ç—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å</p>
                    </div>
                </div>

                <button class="start-btn" onclick="startTest()">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç ‚Üí</button>
            </div>
        </div>

        <!-- Questions will be rendered here -->
        <div id="questionsContainer"></div>

        <!-- Results Screen -->
        <div class="results-screen" id="resultsScreen">
            <div class="loading-analysis" id="loadingAnalysis">
                <div class="loading-spinner"></div>
                <h3>üß† –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é —Ç–≤–æ–∏ –æ—Ç–≤–µ—Ç—ã...</h3>
                <p>Edu Hub AI –∏–∑—É—á–∞–µ—Ç —Ç–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ –ø–æ–¥–±–∏—Ä–∞–µ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏</p>
            </div>

            <div class="analysis-result" id="analysisResult">
                <div class="result-header">
                    <div class="big-emoji">üéØ</div>
                    <h2>–¢–≤–æ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
                </div>
                <div class="ai-response" id="aiResponse"></div>
                <button class="retry-btn" onclick="location.reload()">üîÑ –ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –∑–∞–Ω–æ–≤–æ</button>
            </div>
        </div>
    </div>

    <script>
        // Questions data
        const questions = [
            // –ë–õ–û–ö 1: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –º–µ—Ç–∞–±–æ–ª–∏–∑–º
            {
                id: 1,
                block: "–ë–ª–æ–∫ 1: –¢–≤–æ–π —Å–ø–æ—Å–æ–± –ø–æ–∑–Ω–∞–Ω–∏—è –º–∏—Ä–∞",
                title: "–ß—Ç–æ —Ç–µ–±—è –∑–∞—Ü–µ–ø–∏–ª–æ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≥–æ–¥?",
                description: "–í—Å–ø–æ–º–Ω–∏, –∫–æ–≥–¥–∞ –∏—Å–∫–∞–ª —á—Ç–æ-—Ç–æ –Ω–µ –¥–ª—è —É—á–µ–±—ã/—Ä–∞–±–æ—Ç—ã, –∞ –ø–æ—Ç–æ–º—É —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–ª–æ. –û —á—ë–º —ç—Ç–æ –±—ã–ª–æ?",
                type: "open",
                placeholder: "–ù–∞–ø—Ä–∏–º–µ—Ä: –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —á—ë—Ä–Ω—ã–µ –¥—ã—Ä—ã, –ø–æ—á–µ–º—É –ª—é–¥–∏ –≤–µ—Ä—è—Ç –≤ —Ç–µ–æ—Ä–∏–∏ –∑–∞–≥–æ–≤–æ—Ä–∞, –∏—Å—Ç–æ—Ä–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –ª—é–±–∏–º–æ–π –∏–≥—Ä—ã..."
            },
            {
                id: 2,
                block: "–ë–ª–æ–∫ 1: –¢–≤–æ–π —Å–ø–æ—Å–æ–± –ø–æ–∑–Ω–∞–Ω–∏—è –º–∏—Ä–∞",
                title: "–ß—Ç–æ —Ç–µ–±–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–µ–µ –∏–∑—É—á–∞—Ç—å?",
                description: "–ö–æ–≥–¥–∞ —É–∑–Ω–∞—ë—à—å —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ, –Ω–∞ —á—Ç–æ –æ–±—Ä–∞—â–∞–µ—à—å –≤–Ω–∏–º–∞–Ω–∏–µ –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å?",
                type: "single",
                options: [
                    { icon: "‚öôÔ∏è", text: "–ö–ê–ö —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –º–µ—Ö–∞–Ω–∏–∫–∞, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –∫–æ–¥, –±–∏–æ–ª–æ–≥–∏—è, —Ñ–∏–∑–∏–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤" },
                    { icon: "üß†", text: "–ü–û–ß–ï–ú–£ –ª—é–¥–∏ —Ç–∞–∫ –ø–æ—Å—Ç—É–ø–∞—é—Ç ‚Äî –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è, –º–æ—Ç–∏–≤—ã, –ø–æ–ª–∏—Ç–∏–∫–∞, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥" },
                    { icon: "üîÄ", text: "–ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–µ–º—ã ‚Äî –∏ —Ç–æ, –∏ –¥—Ä—É–≥–æ–µ –º–æ–∂–µ—Ç –∑–∞—Ü–µ–ø–∏—Ç—å" }
                ]
            },
            {
                id: 3,
                block: "–ë–ª–æ–∫ 1: –¢–≤–æ–π —Å–ø–æ—Å–æ–± –ø–æ–∑–Ω–∞–Ω–∏—è –º–∏—Ä–∞",
                title: "–î–µ—Ç–∞–ª–∏ –∏–ª–∏ –±–æ–ª—å—à–∞—è –∫–∞—Ä—Ç–∏–Ω–∞?",
                description: "–ö–∞–∫ —Ç—ã –æ–±—ã—á–Ω–æ –∏–∑—É—á–∞–µ—à—å –Ω–æ–≤—É—é —Ç–µ–º—É?",
                type: "single",
                options: [
                    { icon: "üîç", text: "–ö–æ–ø–∞—é—Å—å –≤ –¥–µ—Ç–∞–ª—è—Ö –∏ —Ü–∏—Ñ—Ä–∞—Ö ‚Äî —Å—Ä–∞–≤–Ω–∏–≤–∞—é —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –∏–∑—É—á–∞—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –ª—é–±–ª—é —Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ" },
                    { icon: "üåå", text: "–ò—â—É –æ–±—â—É—é –∫–∞—Ä—Ç–∏–Ω—É –∏ —Å–º—ã—Å–ª—ã ‚Äî —Ç—Ä–µ–Ω–¥—ã, —Ç–µ–æ—Ä–∏–∏, —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è, –∫–∞–∫ –≤—Å—ë —Å–≤—è–∑–∞–Ω–æ" },
                    { icon: "‚öñÔ∏è", text: "–°–Ω–∞—á–∞–ª–∞ –æ–±—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∞, –ø–æ—Ç–æ–º –ø–æ–≥—Ä—É–∂–∞—é—Å—å –≤ –≤–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏" }
                ]
            },

            // –ë–õ–û–ö 2: –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å
            {
                id: 4,
                block: "–ë–ª–æ–∫ 2: –¢–≤–æ–π —Å—Ç–∏–ª—å —Ä–∞–±–æ—Ç—ã",
                title: "–ö–∞–∫—É—é —á–∞—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ –æ—Å—Ç–∞–≤–∏—à—å —Å–µ–±–µ?",
                description: "–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ –æ—Ä–≥–∞–Ω–∏–∑—É–µ—à—å –±–æ–ª—å—à–æ–π —Ñ–µ—Å—Ç–∏–≤–∞–ª—å –∏–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—à—å —Å—Ç–∞—Ä—Ç–∞–ø. –ß—Ç–æ –±—ã —Ç—ã –≤–∑—è–ª –Ω–∞ —Å–µ–±—è, –∞ —á—Ç–æ —Å —É–∂–∞—Å–æ–º –æ—Ç–¥–∞–ª –±—ã –¥—Ä—É–≥–∏–º?",
                type: "multi",
                maxSelect: 2,
                options: [
                    { icon: "üí°", text: "–ü—Ä–∏–¥—É–º—ã–≤–∞—Ç—å –∏–¥–µ–∏ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é ‚Äî –∫—Ä–µ–∞—Ç–∏–≤ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ" },
                    { icon: "üìä", text: "–°—á–∏—Ç–∞—Ç—å –±—é–¥–∂–µ—Ç, –∏—Å–∫–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã ‚Äî –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ" },
                    { icon: "ü§ù", text: "–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã, –ø—Ä–æ–¥–∞–∂–∏, –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ ‚Äî –æ–±—â–µ–Ω–∏–µ —Å –ª—é–¥—å–º–∏" },
                    { icon: "üî®", text: "–î–µ–ª–∞—Ç—å —Ä—É–∫–∞–º–∏: –ø–∏—Å–∞—Ç—å –∫–æ–¥, —Ç–µ–∫—Å—Ç—ã, —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç ‚Äî —Ä–µ–º–µ—Å–ª–æ" },
                    { icon: "üîé", text: "–ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ, –∏—Å–∫–∞—Ç—å –æ—à–∏–±–∫–∏ ‚Äî –∞—É–¥–∏—Ç –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ" },
                    { icon: "üëë", text: "–£–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥–æ–π, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –∑–∞–¥–∞—á–∏ ‚Äî –ª–∏–¥–µ—Ä—Å—Ç–≤–æ" }
                ]
            },
            {
                id: 5,
                block: "–ë–ª–æ–∫ 2: –¢–≤–æ–π —Å—Ç–∏–ª—å —Ä–∞–±–æ—Ç—ã",
                title: "–ö–æ–≥–¥–∞ —Ç—ã –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø–æ—Ç–æ–∫–∞?",
                description: "–ü—Ä–∏ –∫–∞–∫–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—Ä–µ–º—è –ª–µ—Ç–∏—Ç –Ω–µ–∑–∞–º–µ—Ç–Ω–æ –∏ —Ç—ã –∑–∞–±—ã–≤–∞–µ—à—å –æ–±–æ –≤—Å—ë–º?",
                type: "open",
                placeholder: "–û–ø–∏—à–∏, —á–µ–º —Ç—ã –∑–∞–Ω–∏–º–∞–µ—à—å—Å—è, –∫–æ–≥–¥–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–≥—Ä—É–∂—ë–Ω –≤ –ø—Ä–æ—Ü–µ—Å—Å..."
            },

            // –ë–õ–û–ö 3: –ê–Ω—Ç–∏-—Ä–µ—Å—É—Ä—Å
            {
                id: 6,
                block: "–ë–ª–æ–∫ 3: –ß—Ç–æ —Ç–µ–±—è –≤—ã–º–∞—Ç—ã–≤–∞–µ—Ç",
                title: "–ß—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—Ç—Ç–æ—Ä–∂–µ–Ω–∏–µ?",
                description: "–í—ã–±–µ—Ä–∏ 1-2 –≤–µ—â–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∑—ã–≤–∞—é—Ç —É —Ç–µ–±—è —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –æ—Ç—Ç–æ—Ä–∂–µ–Ω–∏–µ, –∑–ª–æ—Å—Ç—å –∏–ª–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω—É—é —É—Å—Ç–∞–ª–æ—Å—Ç—å:",
                type: "multi",
                maxSelect: 2,
                options: [
                    { icon: "üåÄ", text: "–•–∞–æ—Å –∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å ‚Äî –Ω–µ—Ç —á—ë—Ç–∫–∏—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, –≤—Å—ë –º–µ–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å" },
                    { icon: "üìã", text: "–ú–æ–Ω–æ—Ç–æ–Ω–Ω–æ—Å—Ç—å –∏ —Ä—É—Ç–∏–Ω–∞ ‚Äî –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ, –Ω—É–∂–Ω–∞ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –¥–µ—Ç–∞–ª—è–º" },
                    { icon: "üíî", text: "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ ‚Äî –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Å–æ–ø–µ—Ä–µ–∂–∏–≤–∞—Ç—å, –≤—ã—Å–ª—É—à–∏–≤–∞—Ç—å –∂–∞–ª–æ–±—ã, —É–≥–æ–≤–∞—Ä–∏–≤–∞—Ç—å" },
                    { icon: "‚ö†Ô∏è", text: "–í—ã—Å–æ–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å ‚Äî –æ—à–∏–±–∫–∞ —Å—Ç–æ–∏—Ç –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–æ, –≤—Å–µ —Å–º–æ—Ç—Ä—è—Ç –Ω–∞ —Ç–µ–±—è" },
                    { icon: "üñ•Ô∏è", text: "–û–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ ‚Äî 8 —á–∞—Å–æ–≤ –ø–µ—Ä–µ–¥ –º–æ–Ω–∏—Ç–æ—Ä–æ–º –±–µ–∑ –æ–±—â–µ–Ω–∏—è —Å –ª—é–¥—å–º–∏" },
                    { icon: "üèÉ", text: "–§–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî –º–Ω–æ–≥–æ –¥–≤–∏–≥–∞—Ç—å—Å—è, —Å—Ç–æ—è—Ç—å –Ω–∞ –Ω–æ–≥–∞—Ö –≤–µ—Å—å –¥–µ–Ω—å" }
                ]
            },
            {
                id: 7,
                block: "–ë–ª–æ–∫ 3: –ß—Ç–æ —Ç–µ–±—è –≤—ã–º–∞—Ç—ã–≤–∞–µ—Ç",
                title: "–û–±—ä—è—Å–Ω–∏ —Å–≤–æ–π –≤—ã–±–æ—Ä",
                description: "–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –≤–µ—â–∏ —Ç–µ–±—è –≤—ã–º–∞—Ç—ã–≤–∞—é—Ç? –ë—ã–ª –ª–∏ –æ–ø—ã—Ç, –∫–æ—Ç–æ—Ä—ã–π —ç—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª?",
                type: "open",
                placeholder: "–†–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ, –ø–æ—á–µ–º—É —ç—Ç–æ –¥–ª—è —Ç–µ–±—è –Ω–µ–≤—ã–Ω–æ—Å–∏–º–æ..."
            },

            // –ë–õ–û–ö 4: –î–æ—Ñ–∞–º–∏–Ω–æ–≤—ã–π —Ç—Ä–∏–≥–≥–µ—Ä
            {
                id: 8,
                block: "–ë–ª–æ–∫ 4: –ß—Ç–æ –ø—Ä–∏–Ω–æ—Å–∏—Ç —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏–µ",
                title: "–û—Ç —á–µ–≥–æ —Ç—ã —á—É–≤—Å—Ç–≤—É–µ—à—å ¬´–Ø –º–æ–ª–æ–¥–µ—Ü!¬ª?",
                description: "–¢—ã –∑–∞–∫–æ–Ω—á–∏–ª —Ä–∞–±–æ—Ç—É. –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏, —á—Ç–æ–±—ã –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å –∫–∞–π—Ñ?",
                type: "single",
                options: [
                    { icon: "üèóÔ∏è", text: "–ú–∞—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –≤–∏–∂—É —Ç–æ, —á—Ç–æ —Å–æ–∑–¥–∞–ª: –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Å—Ç–∞—Ç—å—è –Ω–∞–ø–∏—Å–∞–Ω–∞, –≤–µ—â—å –≥–æ—Ç–æ–≤–∞" },
                    { icon: "üèÜ", text: "–í–ª–∏—è–Ω–∏–µ –∏ –ø–æ–±–µ–¥–∞ ‚Äî —É–±–µ–¥–∏–ª –ª—é–¥–µ–π, –ø–æ–±–µ–¥–∏–ª –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤, –º–æ—è –∫–æ–º–∞–Ω–¥–∞ –ª—É—á—à–∞—è" },
                    { icon: "üôè", text: "–ü–æ–º–æ—â—å –∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å ‚Äî —á–µ–ª–æ–≤–µ–∫ —É–ª—ã–±–Ω—É–ª—Å—è, —Å–∫–∞–∑–∞–ª —Å–ø–∞—Å–∏–±–æ, —è –æ–±–ª–µ–≥—á–∏–ª —á—å—é-—Ç–æ –∂–∏–∑–Ω—å" },
                    { icon: "üí°", text: "–ò–Ω—Å–∞–π—Ç –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ ‚Äî –ø–æ–Ω—è–ª –∫–∞–∫ —ç—Ç–æ —É—Å—Ç—Ä–æ–µ–Ω–æ, –Ω–∞—à—ë–ª —Ä–µ—à–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ–π –∑–∞–¥–∞—á–∏" },
                    { icon: "üé®", text: "–°–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏–µ ‚Äî —Å–æ–∑–¥–∞–ª —á—Ç–æ-—Ç–æ –∫—Ä–∞—Å–∏–≤–æ–µ/—É–Ω–∏–∫–∞–ª—å–Ω–æ–µ, –≤—ã—Ä–∞–∑–∏–ª —Å–µ–±—è" }
                ]
            },

            // –ë–õ–û–ö 5: –¢–µ—Å—Ç –Ω–∞ –∞–ø–æ–∫–∞–ª–∏–ø—Å–∏—Å
            {
                id: 9,
                block: "–ë–ª–æ–∫ 5: –¢–≤–æ—è –ø—Ä–∏—Ä–æ–¥–Ω–∞—è —Ä–æ–ª—å",
                title: "–ö–µ–º –±—ã —Ç—ã —Å—Ç–∞–ª –≤ –æ–±—â–∏–Ω–µ –±–µ–∑ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π?",
                description: "–¶–∏–≤–∏–ª–∏–∑–∞—Ü–∏—è –æ—Ç–∫–∞—Ç–∏–ª–∞—Å—å –Ω–∞ 100 –ª–µ—Ç. –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –Ω–µ—Ç, –æ—Ñ–∏—Å–æ–≤ –Ω–µ—Ç. –ï—Å—Ç—å –æ–±—â–∏–Ω–∞ –ª—é–¥–µ–π. –ö–∞–∫—É—é —Ä–æ–ª—å –∑–∞–π–º—ë—à—å?",
                type: "single",
                options: [
                    { icon: "üìö", text: "–£—á–∏—Ç–µ–ª—å/–ú—É–¥—Ä–µ—Ü ‚Äî —Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∑–Ω–∞–Ω–∏—è" },
                    { icon: "üîß", text: "–ò–Ω–∂–µ–Ω–µ—Ä/–°—Ç—Ä–æ–∏—Ç–µ–ª—å ‚Äî —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —á–∏–Ω–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º—ã" },
                    { icon: "ü§ù", text: "–¢–æ—Ä–≥–æ–≤–µ—Ü/–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—â–∏–∫ ‚Äî –¥–æ–≥–æ–≤–∞—Ä–∏–≤–∞—Ç—å—Å—è, –æ–±–º–µ–Ω–∏–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã" },
                    { icon: "üëë", text: "–õ–∏–¥–µ—Ä/–í–æ–∂–¥—å ‚Äî –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, —Å—É–¥–∏—Ç—å —Å–ø–æ—Ä—ã" },
                    { icon: "üíä", text: "–¶–µ–ª–∏—Ç–µ–ª—å ‚Äî –ª–µ—á–∏—Ç—å –ª—é–¥–µ–π, –∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ –∑–¥–æ—Ä–æ–≤—å–µ" },
                    { icon: "üó∫Ô∏è", text: "–†–∞–∑–≤–µ–¥—á–∏–∫/–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å ‚Äî –∏—Å–∫–∞—Ç—å –Ω–æ–≤—ã–µ –∑–µ–º–ª–∏ –∏ —Ä–µ—Å—É—Ä—Å—ã" },
                    { icon: "üé≠", text: "–ê—Ä—Ç–∏—Å—Ç/–õ–µ—Ç–æ–ø–∏—Å–µ—Ü ‚Äî –ø–æ–¥–Ω–∏–º–∞—Ç—å –¥—É—Ö, —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Å—Ç–æ—Ä–∏–∏" }
                ]
            },

            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å
            {
                id: 10,
                block: "–§–∏–Ω–∞–ª—å–Ω—ã–π –±–ª–æ–∫",
                title: "–ß—Ç–æ –µ—â—ë –≤–∞–∂–Ω–æ –∑–Ω–∞—Ç—å –æ —Ç–µ–±–µ?",
                description: "–†–∞—Å—Å–∫–∞–∂–∏ –æ —Å–≤–æ–∏—Ö –Ω–∞–≤—ã–∫–∞—Ö, —Ö–æ–±–±–∏, –º–µ—á—Ç–∞—Ö –∏–ª–∏ —Å–æ–º–Ω–µ–Ω–∏—è—Ö. –ß—Ç–æ –±—ã —Ç—ã —Ö–æ—Ç–µ–ª, —á—Ç–æ–±—ã AI —É—á—ë–ª –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ?",
                type: "open",
                placeholder: "–õ—é–±–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–∂–µ—Ç –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å —Ç–µ–±—è: —É–≤–ª–µ—á–µ–Ω–∏—è, —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã, —Å—Ç—Ä–∞—Ö–∏, –º–µ—á—Ç—ã..."
            }
        ];

        let currentQuestion = 0;
        let answers = {};

        function startTest() {
            document.getElementById('introScreen').classList.remove('active');
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('progressText').style.display = 'block';
            renderQuestions();
            showQuestion(0);
        }

        function renderQuestions() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';

            questions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `question-${index}`;

                let inputHtml = '';

                if (q.type === 'open') {
                    inputHtml = `
                        <textarea class="open-answer" 
                                  id="answer-${q.id}" 
                                  placeholder="${q.placeholder}"
                                  oninput="saveOpenAnswer(${q.id}, this.value)"></textarea>
                    `;
                } else if (q.type === 'single') {
                    inputHtml = `<div class="options-container">`;
                    q.options.forEach((opt, optIndex) => {
                        inputHtml += `
                            <button class="option-btn" onclick="selectSingle(${q.id}, ${optIndex}, this)">
                                <span class="option-icon">${opt.icon}</span>
                                ${opt.text}
                            </button>
                        `;
                    });
                    inputHtml += `</div>`;
                } else if (q.type === 'multi') {
                    inputHtml = `
                        <p class="multi-select-info">–í—ã–±–µ—Ä–∏ ${q.maxSelect} –≤–∞—Ä–∏–∞–Ω—Ç–∞</p>
                        <div class="options-container">
                    `;
                    q.options.forEach((opt, optIndex) => {
                        inputHtml += `
                            <button class="option-btn" onclick="selectMulti(${q.id}, ${optIndex}, ${q.maxSelect}, this)">
                                <span class="option-icon">${opt.icon}</span>
                                ${opt.text}
                            </button>
                        `;
                    });
                    inputHtml += `</div>`;
                }

                card.innerHTML = `
                    <span class="block-badge">${q.block}</span>
                    <h2 class="question-title">${q.title}</h2>
                    <p class="question-description">${q.description}</p>
                    ${inputHtml}
                    <div class="nav-buttons">
                        <button class="nav-btn back" onclick="prevQuestion()" ${index === 0 ? 'style="visibility:hidden"' : ''}>
                            ‚Üê –ù–∞–∑–∞–¥
                        </button>
                        <button class="nav-btn next" id="next-${index}" onclick="nextQuestion()">
                            ${index === questions.length - 1 ? '–ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí' : '–î–∞–ª–µ–µ ‚Üí'}
                        </button>
                    </div>
                `;

                container.appendChild(card);
            });
        }

        function showQuestion(index) {
            document.querySelectorAll('.question-card').forEach(card => {
                card.classList.remove('active');
            });
            document.getElementById(`question-${index}`).classList.add('active');
            
            // Update progress
            const progress = ((index + 1) / questions.length) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = `–í–æ–ø—Ä–æ—Å ${index + 1} –∏–∑ ${questions.length}`;
            
            currentQuestion = index;
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function saveOpenAnswer(questionId, value) {
            answers[questionId] = value;
        }

        function selectSingle(questionId, optionIndex, btn) {
            const container = btn.parentElement;
            container.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            answers[questionId] = questions.find(q => q.id === questionId).options[optionIndex].text;
        }

        function selectMulti(questionId, optionIndex, maxSelect, btn) {
            const container = btn.parentElement;
            const selected = container.querySelectorAll('.option-btn.selected');
            
            if (btn.classList.contains('selected')) {
                btn.classList.remove('selected');
            } else if (selected.length < maxSelect) {
                btn.classList.add('selected');
            } else {
                selected[0].classList.remove('selected');
                btn.classList.add('selected');
            }

            const selectedBtns = container.querySelectorAll('.option-btn.selected');
            const question = questions.find(q => q.id === questionId);
            answers[questionId] = Array.from(selectedBtns).map(b => {
                const index = Array.from(container.children).indexOf(b);
                return question.options[index].text;
            });
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                showQuestion(currentQuestion + 1);
            } else {
                submitTest();
            }
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                showQuestion(currentQuestion - 1);
            }
        }

        async function submitTest() {
            document.getElementById('progressContainer').style.display = 'none';
            document.getElementById('progressText').style.display = 'none';
            document.getElementById('questionsContainer').style.display = 'none';
            document.getElementById('resultsScreen').classList.add('active');

            let analysisPrompt = `–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –¥–∞–π –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è–º.

–û–¢–í–ï–¢–´ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø:

`;
            questions.forEach(q => {
                const answer = answers[q.id];
                if (answer) {
                    analysisPrompt += `**${q.title}**\n`;
                    if (Array.isArray(answer)) {
                        analysisPrompt += answer.join(', ') + '\n\n';
                    } else {
                        analysisPrompt += answer + '\n\n';
                    }
                }
            });

            analysisPrompt += `
---
–ù–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤:

1. **–ü–°–ò–•–û–õ–û–ì–ò–ß–ï–°–ö–ò–ô –ü–†–û–§–ò–õ–¨** ‚Äî –∫—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏ —Ç–∏–ø –ª–∏—á–Ω–æ—Å—Ç–∏ —á–µ–ª–æ–≤–µ–∫–∞ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)

2. **–¢–û–ü-3 –ò–î–ï–ê–õ–¨–ù–´–ï –ü–†–û–§–ï–°–°–ò–ò** ‚Äî –¥–ª—è –∫–∞–∂–¥–æ–π —É–∫–∞–∂–∏:
   - –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏
   - –ü–æ—á–µ–º—É –ø–æ–¥—Ö–æ–¥–∏—Ç (–Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–æ–≤)
   - –ó–∞—Ä–ø–ª–∞—Ç–∞ –≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ (–æ—Ç-–¥–æ)
   - –ì–¥–µ —É—á–∏—Ç—å—Å—è (–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤—É–∑—ã –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞)

3. **–ü–†–û–§–ï–°–°–ò–ò, –ö–û–¢–û–†–´–• –°–¢–û–ò–¢ –ò–ó–ë–ï–ì–ê–¢–¨** ‚Äî 2-3 –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤—ã–º–∞—Ç—ã–≤–∞—Ç—å

4. **–°–û–í–ï–¢ –ù–ê –ë–£–î–£–©–ï–ï** ‚Äî –æ–¥–Ω–æ –Ω–∞–ø—É—Ç—Å—Ç–≤–∏–µ

–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞: —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, —Å —ç–º–æ–¥–∑–∏, –ª–µ–≥–∫–æ —á–∏—Ç–∞–µ–º—ã–π.`;

            try {
                const response = await fetch('/ai-chat/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: analysisPrompt,
                        history: []
                    })
                });

                const data = await response.json();
                
                document.getElementById('loadingAnalysis').style.display = 'none';
                document.getElementById('analysisResult').classList.add('show');
                document.getElementById('aiResponse').innerHTML = formatResponse(data.response);

            } catch (error) {
                document.getElementById('loadingAnalysis').innerHTML = `
                    <h3>üòï –£–ø—Å, —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫</h3>
                    <p>–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑</p>
                    <button class="retry-btn" onclick="location.reload()">üîÑ –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                `;
            }
        }

        function formatResponse(text) {
            return text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\n/g, '<br>')
                .replace(/---/g, '<hr style="border-color: rgba(255,255,255,0.1); margin: 20px 0;">')
                .replace(/#{3}\s?(.*?)(?=<br>|$)/g, '<h4>$1</h4>')
                .replace(/#{2}\s?(.*?)(?=<br>|$)/g, '<h3>$1</h3>');
        }
    </script>
</body>
</html>
